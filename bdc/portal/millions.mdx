---
title: "Millions"
---

## Non-Technical

### Overview

This [Millions](https://www.bergendebate.com/portal/millions) page allows users to monitor their Millions balance, view detailed transaction history, and manage credits or rewards associated with each student.

![Image](/images/image-23.png)

**Current Balance: **This section shows the **current available Millions balance** for the selected student.

**Transactions:**  displays the history of Millions activity for the selected student. Each entry shows the transaction **date, description,** and the **amount** added or deducted (± Millions).

## Admins (Retool)

### Manage “Million Items” in Retool

[This page](https://bergendebate.retool.com/apps/65bce3c6-5749-11f0-93e7-5bde07f21a93/Q2%6025/Millions%20Items/page1) allows you to update the millions store (view/edit existing items, add new ones).

<Info>
  Currently, we are not making use of the Millions Store
</Info>

### Millions Dashboard Retool

The [Millions Dashboard](https://bergendebate.retool.com/apps/95b9c6b4-ed69-11f0-98f8-e7d3bb45fb10/Q1%6026/Millions_Dashboard%20Q1%6026/page1) displays a list of students **based on the selected filters** such as year, session, location, class level, or student name. For each student record, you can view their million balance.

**Available actions include:**

- **Edit Millions** – Opens a popup to add or adjust Millions with a brief description.

  ![Image](/images/image-30.png)
- **View Transaction** – Opens a popup showing the student’s Millions transaction history.

  ![Image](/images/image-32.png)

## Technical

TODO: Explain in detail how millions works (from Retool update to render here). Include DB

<Warning>
  Note: Please skip the BDC Millions store for now, since we aren't using it

  SK -- let's get BDC admin to populate this
</Warning>

This section describes only the **Millions page** ([portal/millions](https://www.bergendebate.com/portal/millions)): how it loads data, where the data lives, and how `millions.js` renders it.

### What the page shows

The Millions page displays **per-student** reward amounts (points). Each student has a single balance and transaction history stored in **millions_transactions** (keyed by **studentId**). The page lists students (tabs), shows **Current Balance** and a **Transactions** table per student, and updates the sidebar count (`[data-millions="sidebarCount"]`) with the selected student's balance as "XM".

### Where the data lives (DB)

- `millions_transactions:` One document per student. Fields: `studentId`, `earnAmount` (current total), `createdOn`, `transactions` (array of  `amount`, `description`, `lastEarnDate` ). 
- `millions_items_details`**:** Catalog for the Millions store (out of scope here).

The read API filters **which students** appear using current year/session (students with a payment in that term); each student's balance is their total (not per-session).

### How the page gets data (API)

- **GET **`getMillionsTransactionData` (member-service)
- Resolves `memberId` to family `memberIds`; uses current year/session to find students with a payment in that term; for each, looks up `millions_transactions` by `studentId` and returns `studentName`, `studentGrade`, `earnAmount`, `transactions`.
- Response: The page uses `millions_transactions`; **items** is for the store (skipped here).

<Note>
  **TODO: Are we still filtering by current year/session? I think we should be showing student millions for all students, regardless of if they have a payment in the term...**
</Note>

### `millions.js` (Page Logic)

- **Class:** `MillionsRenderer`. Used only on the Millions page.
- **Entry:** `constructor(data)` with `apiBaseURL`, `memberId`; calls `init()`.
- `init()`**:** Shows loading state; calls `fetchData()` → **GET **`getMillionsTransactionData`. If no `millions_transactions` or empty, shows `[data-container="no-record-found"]` and exits. Otherwise shows tab and wrapper, then calls the following ~~renderTabMenu(millions_transactions), renderTabContent(millions_transactions), renderTab(idx, student) for each, setupTabSwitching(millions_transactions).~~

<Note>
  TODO: What is `setupTabSwitching(millions_transactions)`?
</Note>

- `renderTabMenu(students)`**:** Clears **.portal-tab-menus**; for each student appends **.portal-tab-link** with student name (Webflow tab structure).
- `renderTabContent(students)`**:** Clears **.portal-tab-content**; for each student creates **.w-tab-pane** with balance (**.million-price-text**) and **.transactions-table-div** (header + **.transactions-row-wrapper** for rows).
- `renderTab(tabIndex, student, link)`**:** Sets **.million-price-text** to `earnAmount`; fills transaction rows (date, description, amount; **green-semi-bold** / **red-semi-bold**). Sorts **student.transactions** by `lastEarnDate` descending. Calls `updateSideBarAmount(earnAmount)` for active tab or on link click.
- `updateSideBarAmount(earnAmount)`**:** Sets `[data-millions="sidebarCount"]` to **earnAmount + "M"**