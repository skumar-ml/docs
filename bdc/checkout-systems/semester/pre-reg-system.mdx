---
title: "Pre-Reg System"
---

Pre-registration allows eligible students to register earlier than the public enrollment so they can secure class spots before regular registration opens. This document explains: (1) the different pre-registration states; (2) what users see in each state; (3) how admins can control and manage these states using Retool.

Pre-registration typically runs **at least one-week** before the start of the general enrollment.

## The Three Pre-Registration States

### 1. Normal Registration State

**This is the default experience** for most users. In this state, pre-registration is not active _and_ the user is not pre-registered for the semester.

**User's see** the standard registration and checkout flow.

### 2. Pre-Registration Information State

This state shows **when** pre-registration is currently active, but the user is _not_ pre-registered for the semester.

The user **sees** (1) a banner message that "Registration is currently open only for Year-Long Bundle students"; (2) a countdown timer showing when pre-registration ends; (3) and some information explaining the benefits of pre-registering for future semesters.

### 3. Bundle Purchase State

This state occurs **when** we recognize the student as having pre-registered for the semester, allowing for early enrollment.

<Note>
  If pre-registration is active, the user can only enroll pre-registered students (they cannot enroll a \_different \_student).
</Note>

Pre-registered users will see that the standard “Pay Now” button is replaced with a “Pre-Register” button. Users can select class locations and times and complete enrollment without payment. Payment is required only if additional programs are added.

## Common Scenarios

| Scenario                         | State                 | User Experience                       |
| :------------------------------- | :-------------------- | :------------------------------------ |
| New user during pre-reg          | Pre-Registration Info | Sees upgrade and discount info        |
| Bundle owner, not pre-registered | Pre-Registration Info | Prompted to complete pre-registration |
| Bundle owner, pre-registered     | Bundle Purchase       | Can pre register                      |
| After pre-reg ends               | Normal                | Standard registration                 |

<Note>
  **TODO: I did not understand scenario #2. We should discuss.**
</Note>

## Retool: Admin Control & Management

Admins manage pre-registration behavior through **Retool**.

<Note>
  TODO: Need to explain

  1. how admin can see who is pre-registered for a semester
  2. how admin can change dates pre-registration is active on the website
</Note>

### Bundle Management Program Page

In Retool, admins can:

- **Add** new students as pre-registered for any future semester
- **Switch** a students pre-registration to a different semester
- **Remove** a student's pre-registration status

Changes made in Retool take effect immediately and determine whether users see pre-registration messaging or discounted checkout.

## Technical Details

<Note>
  TODO: SK needs to review this section
</Note>

TODO: Give a technical explanation of how these states are calculated for each user. How the user can "auto-enroll" without making a payment.

### Pre-Registration & Auto-Enrollment State Logic

This section explains how the frontend determines a user’s pre-registration state and when payment is required.

### Overview

The frontend determines a user’s state by calling the backend API "getYearLongBundleDetails/webflowMemberId"

Based on the API response (`message` and `data`), the frontend calculates the current **user state** and decides:

- What UI to show
- Whether the user can **auto-enroll**
- Whether payment is required or not

## API Response Structure

The API returns the following fields:

```
{
  "message": "string",
  "data": [],
  "preRegistrationEndDate": "YYYY-MM-DD"
}
```

### Key Fields

| Field                    | Purpose                                                     |
| :----------------------- | :---------------------------------------------------------- |
| `message`                | Indicates the current phase of pre-registration             |
| `data`                   | Contains bundle details if the user is eligible to purchase |
| `preRegistrationEndDate` | Used for countdowns                                         |

## State Determination Logic

The frontend evaluates the response using the following logic:

```
var enrollmentState = "Normal"
this.fetchData("getYearLongBundleDetails/" + this.webflowMemberId)
  .then((data) => {
    if (
      data.message &&
      data.data.length == 0 &&
      data.message == "Either pre-registration not yet started or already ended"
    ) {
      enrollmentState = "Normal";
    }
    else if (
      data.data &&
      data.data.length == 0 &&
      data.message == "Pre-registration is going on"
    ) {
      enrollmentState = "Pre-Registration-Info"; // Showing banner
    }
    else if (
      data.data &&
      data.data.length > 0 &&
      data.message == "Pre-registration is going on"
    ) {
      enrollmentState = "Bundle-Purchase"; // Pre-registartion purchase
    }
  });
```

## Defined User States

### 1. **Normal**

**Condition**

- `message = "Either pre-registration not yet started or already ended"`
- `data.length = 0`

**Meaning**

Pre-registration has not started or has already ended. Users proceed with standard enrollment and payment if applicable.

### 2. **Pre-Registration-Info**

**Condition**

- `message = "Pre-registration is going on"`
- `data.length = 0`

**Meaning**

Pre-registration is active, but the user has no eligible bundle data. Only informational banners and countdowns are shown.

### 3. **Bundle-Purchase**

**Condition**

- `message = "Pre-registration is going on"`
- `data.length > 0`

**Meaning**

Pre-registration is active and bundle data exists. The user can select classes and complete pre-registration.

If no add-ons are selected, enrollment completes **without payment**. Payment is required only when optional bundle programs are added.