---
title: "Pre-Reg System"
---

## Admin Details

TODO: Give a non-technical explanation of all the different states for the pre-reg system, and how they can be controlled via Retool

The pre-registration system controls how and when students with **year-long bundle programs** can register early for upcoming semesters.

This document explains:

- The different pre-registration states
- What users see in each state
- How admins can control and manage these states using Retool

## Overview

Pre-registration allows eligible students to:

- Register earlier than general enrollment
- Secure class spots before regular registration opens

The system automatically places each user into the correct state based on **timing** and **bundle ownership**.

## The Three Pre-Registration States

### 1. Normal Registration State

This is the default experience for most users.

#### What This Means

- Pre-registration is not currently active **or**
- The user does not have a year-long bundle program

#### What Users See

- Standard registration and checkout flow
- Regular pricing
- No pre-registration messaging or banner

### 2. Pre-Registration Information State

This is an informational state that highlights pre-registration eligibility.

#### What This Means

- Pre-registration is currently active
- The user is eligible (has pre-register a year-long bundle)
- The user has **not yet completed** pre-registration

#### What Users See

- Banner message:

  > “Registration is currently open only for Year-Long Bundle students”
- Countdown timer showing when pre-registration ends
- Information about discounts and early access

#### When This Happens

- Pre-registration window is open
- User has not completed pre-registration

### 3. Bundle Purchase State

This state allows eligible users to complete pre registration

#### What This Means

- Pre-registration is active
- The system recognizes the student as part of a bundle program

#### What Users See

- “Pre-Register” button instead of “Register”
- Option to add Bundle programs or briefs

#### When This Happens

- Pre-registration window is active
- Student has been matched to a bundle program

#### What Users Can Do

- Select class locations and times
- Add optional programs or briefs
- Secure class spots early

## How the System Determines the State

The system automatically checks:

1. **Pre-Registration Dates**
   - Has pre-registration started?
   - Has it ended?
2. **Bundle Ownership**
   - Does the user have a year-long bundle?
   - Has pre-registration already been completed?
3. **Student Matching**
   - Does the student name match a bundle record?
   - Is the student eligible for early registration?

## Common Scenarios

| Scenario                         | State                 | User Experience                       |
| :------------------------------- | :-------------------- | :------------------------------------ |
| New user during pre-reg          | Pre-Registration Info | Sees upgrade and discount info        |
| Bundle owner, not pre-registered | Pre-Registration Info | Prompted to complete pre-registration |
| Bundle owner, pre-registered     | Bundle Purchase       | Can pre register                      |
| After pre-reg ends               | Normal                | Standard registration                 |
| Before pre-reg starts            | Normal                | Standard registration                 |

## Retool: Admin Control & Management

Admins manage pre-registration behavior through **Retool**.

### Bundle Management Program Page

In Retool, admins can:

- Add new bundle programs
- Switch students between bundle programs
- Remove students from bundle programs

These actions directly affect which pre-registration state a user sees.

Changes made in Retool take effect immediately and determine whether users see pre-registration messaging or discounted checkout.

## Summary

The pre-registration system has three clear states:

1. **Normal Registration** – Standard experience for all users
2. **Pre-Registration Information** – Awareness and upgrade opportunity
3. **Bundle Purchase** – Discounted checkout and early access

**In retool, we have a bundle management program page there user can add, switch, and delete the bundle program**

## Technical Details

TODO: Give a technical explanation of how these states are calculated for each user. How the user can "auto-enroll" without making a payment.

### Pre-Registration & Auto-Enrollment State Logic

### Overview

The system determines a user’s **pre-registration and bundle state** by calling the backend API:

```
GET getYearLongBundleDetails/{webflowMemberId}
```

Based on the API response (`message` and `data`), the frontend calculates the current **user state** and decides:

- What UI to show
- Whether the user can **auto-enroll**
- Whether payment is required or not

## API Response Structure

The API returns the following fields:

```
{
  "message": "string",
  "data": [],
  "preRegistrationEndDate": "YYYY-MM-DD"
}
```

### Key Fields

| Field                    | Purpose                                                     |
| :----------------------- | :---------------------------------------------------------- |
| `message`                | Indicates the current phase of pre-registration             |
| `data`                   | Contains bundle details if the user is eligible to purchase |
| `preRegistrationEndDate` | Used for countdowns                                         |

## State Determination Logic

The frontend evaluates the response using the following logic:

```
var enrollmentState = "Normal"
this.fetchData("getYearLongBundleDetails/" + this.webflowMemberId)
  .then((data) => {
    if (
      data.message &&
      data.data.length == 0 &&
      data.message == "Either pre-registration not yet started or already ended"
    ) {
      enrollmentState = "Normal";
    }
    else if (
      data.data &&
      data.data.length == 0 &&
      data.message == "Pre-registration is going on"
    ) {
      enrollmentState = "Pre-Registration-Info"; // Showing banner
    }
    else if (
      data.data &&
      data.data.length > 0 &&
      data.message == "Pre-registration is going on"
    ) {
      enrollmentState = "Bundle-Purchase"; // Pre-registartion purchase
    }
  });
```

## Defined User States

### 1. **Normal**

**Condition**

- `message = "Either pre-registration not yet started or already ended"`
- `data.length = 0`

**Meaning**

- Pre-registration is not active
- User proceeds with standard enrollment flow
- Payment is required if applicable

### 2. **Pre-Registration-Info**

**Condition**

- `message = "Pre-registration is going on"`
- `data.length = 0`

**Meaning**

- Pre-registration window is active
- Only pre-registartion window will display
- User is **not eligible for bundle purchase**

### 3. **Bundle-Purchase**

**Condition**

- `message = "Pre-registration is going on"`
- `data.length > 0`

**Meaning**

- Pre-registration is active
- User is eligible to pre-register for a **Year-Long Bundle**
- user just needs to select the class and click on the  pre-register button. no need for payment
- Payment is required to complete enrollment if they added bundle programs with pre-register