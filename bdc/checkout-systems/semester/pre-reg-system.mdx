---
title: "Pre-Reg System"
---

## Admin Details

TODO: Give a non-technical explanation of all the different states for the pre-reg system, and how they can be controlled via Retool

The pre-registration system controls how and when students with **year-long bundle programs** can register early for upcoming semesters.

This document explains:

- The different pre-registration states
- What users see in each state
- How admins can control and manage these states using Retool

## Overview

Pre-registration allows eligible students to:

- Register earlier than general enrollment
- Secure class spots before regular registration opens

The system automatically places each user into the correct state based on **timing** and **bundle ownership**.

## The Three Pre-Registration States

### 1. Normal Registration State

This is the default experience for most users.

#### What This Means

Pre-registration is not active, or the user does not have a year-long bundle.

#### What Users See

Users follow the standard registration and checkout flow.\
There is no pre-registration banner, discount messaging, or early access.

### 2. Pre-Registration Information State

This is an informational state that highlights pre-registration eligibility.

#### What This Means

Pre-registration is currently active, but the user has not completed pre-registration yet.

#### What Users See

- Banner message:

  > “Registration is currently open only for Year-Long Bundle students”
- Countdown timer showing when pre-registration ends
- Information about discounts and early access

### 3. Bundle Purchase State

This state allows eligible users to complete pre registration

#### What This Means

The system recognizes the student as part of a year-long bundle and allows early enrollment.

#### What Users See

The standard “Pay Now” button is replaced with a “Pre-Register” button.\
Users can select class locations and times and optionally add bundle programs or briefs.

#### What Users Can Do

Users can secure class spots early. If no add-ons are selected, enrollment can complete without payment. Payment is required only if additional programs are added.

## How the System Determines the State

The system automatically checks:

1. **Pre-Registration Dates**
   - Has pre-registration started?
   - Has it ended?
2. **Bundle Ownership**
   - Does the user have a year-long bundle?
   - Has pre-registration already been completed?
3. **Student Matching**
   - Does the student name match a bundle record?
   - Is the student eligible for early registration?

## Common Scenarios

| Scenario                         | State                 | User Experience                       |
| :------------------------------- | :-------------------- | :------------------------------------ |
| New user during pre-reg          | Pre-Registration Info | Sees upgrade and discount info        |
| Bundle owner, not pre-registered | Pre-Registration Info | Prompted to complete pre-registration |
| Bundle owner, pre-registered     | Bundle Purchase       | Can pre register                      |
| After pre-reg ends               | Normal                | Standard registration                 |
| Before pre-reg starts            | Normal                | Standard registration                 |

## Retool: Admin Control & Management

Admins manage pre-registration behavior through **Retool**.

### Bundle Management Program Page

In Retool, admins can:

- Add new bundle programs
- Switch students between bundle programs
- Remove students from bundle programs

These actions directly affect which pre-registration state a user sees.

Changes made in Retool take effect immediately and determine whether users see pre-registration messaging or discounted checkout.

## Technical Details

TODO: Give a technical explanation of how these states are calculated for each user. How the user can "auto-enroll" without making a payment.

### Pre-Registration & Auto-Enrollment State Logic

This section explains how the frontend determines a user’s pre-registration state and when payment is required.

### Overview

The frontend determines a user’s state by calling the backend API "getYearLongBundleDetails/{webflowMemberId}"

Based on the API response (`message` and `data`), the frontend calculates the current **user state** and decides:

- What UI to show
- Whether the user can **auto-enroll**
- Whether payment is required or not

## API Response Structure

The API returns the following fields:

```
{
  "message": "string",
  "data": [],
  "preRegistrationEndDate": "YYYY-MM-DD"
}
```

### Key Fields

| Field                    | Purpose                                                     |
| :----------------------- | :---------------------------------------------------------- |
| `message`                | Indicates the current phase of pre-registration             |
| `data`                   | Contains bundle details if the user is eligible to purchase |
| `preRegistrationEndDate` | Used for countdowns                                         |

## State Determination Logic

The frontend evaluates the response using the following logic:

```
var enrollmentState = "Normal"
this.fetchData("getYearLongBundleDetails/" + this.webflowMemberId)
  .then((data) => {
    if (
      data.message &&
      data.data.length == 0 &&
      data.message == "Either pre-registration not yet started or already ended"
    ) {
      enrollmentState = "Normal";
    }
    else if (
      data.data &&
      data.data.length == 0 &&
      data.message == "Pre-registration is going on"
    ) {
      enrollmentState = "Pre-Registration-Info"; // Showing banner
    }
    else if (
      data.data &&
      data.data.length > 0 &&
      data.message == "Pre-registration is going on"
    ) {
      enrollmentState = "Bundle-Purchase"; // Pre-registartion purchase
    }
  });
```

## Defined User States

### 1. **Normal**

**Condition**

- `message = "Either pre-registration not yet started or already ended"`
- `data.length = 0`

**Meaning**

Pre-registration has not started or has already ended. Users proceed with standard enrollment and payment if applicable.

### 2. **Pre-Registration-Info**

**Condition**

- `message = "Pre-registration is going on"`
- `data.length = 0`

**Meaning**

Pre-registration is active, but the user has no eligible bundle data. Only informational banners and countdowns are shown.

### 3. **Bundle-Purchase**

**Condition**

- `message = "Pre-registration is going on"`
- `data.length > 0`

**Meaning**

Pre-registration is active and bundle data exists. The user can select classes and complete pre-registration.

If no add-ons are selected, enrollment completes **without payment**. Payment is required only when optional bundle programs are added.